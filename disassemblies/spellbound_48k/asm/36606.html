<!DOCTYPE html>
<html>
<head>
<title>Spellbound (48k): Routine at 36606</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
<link rel="stylesheet" type="text/css" href="../common.css" />
<link rel="stylesheet" type="text/css" href="../spectrum.css" />
<link rel="stylesheet" type="text/css" href="../spellbound.css" />
<script type="text/javascript" src="../js/require.js"></script>
<script type="text/javascript" src="../js/main.js"></script>
<script type="text/javascript" src="../js/bootstrap.js"></script>
</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html"><img alt="logo" src="../images/logo.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="36586.html">36586</a>
</td>
<td class="up">Up: <a href="../maps/all.html#36606">Map</a></td>
<td class="next">
Next: <a href="36626.html">36626</a>
</td>
</tr>
</table>
<div class="description">36606: Advance display file pointer to next location (for printing room name)</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
<div class="paragraph">
Used by the routines at <a href="36475.html">36475</a> and <a href="36875.html">36875</a>.
</div>
</div>
</td>
</tr>
<tr>
<td class="address-2"><span id="36606"></span>36606</td>
<td class="instruction">LD HL,(36488)</td>
<td class="comment-1" rowspan="1">Get display file byte to modify...</td>
</tr>
<tr>
<td class="address-1"><span id="36609"></span>36609</td>
<td class="instruction">INC HL</td>
<td class="comment-1" rowspan="1">...and increase (for next character)</td>
</tr>
<tr>
<td class="address-1"><span id="36610"></span>36610</td>
<td class="instruction">LD A,L</td>
<td class="comment-1" rowspan="1">Load LSB of <span class="register">HL</span> into <span class="register">A</span>...</td>
</tr>
<tr>
<td class="address-1"><span id="36611"></span>36611</td>
<td class="instruction">OR A</td>
<td class="comment-1" rowspan="1">...and check whether it is zero</td>
</tr>
<tr>
<td class="address-1"><span id="36612"></span>36612</td>
<td class="instruction">JR Z,36618</td>
<td class="comment-1" rowspan="1">If it is zero (i.e. advancing down a character row will take us into a different third) then skip to second part of routine...</td>
</tr>
<tr>
<td class="address-1"><span id="36614"></span>36614</td>
<td class="instruction">LD (36488),HL</td>
<td class="comment-1" rowspan="1">...else store the updated (increased) display file address for next character...</td>
</tr>
<tr>
<td class="address-1"><span id="36617"></span>36617</td>
<td class="instruction">RET</td>
<td class="comment-1" rowspan="1">...and return</td>
</tr>
<tr>
<td class="address-2"><span id="36618"></span>36618</td>
<td class="instruction">LD A,H</td>
<td class="comment-1" rowspan="3">Add 7 to MSB of display file address as advancing by one at <a href="36606.html#36609">36609</a> took display file pointer back up to 2nd pixel row of the current third of the display when in fact we need to move to top pixel row of the NEXT third of the display (i.e. 7 &times; 32 &times; 8 = 7 &times; 256 bytes on from this!)</td>
</tr>
<tr>
<td class="address-1"><span id="36619"></span>36619</td>
<td class="instruction">ADD A,7</td>
</tr>
<tr>
<td class="address-1"><span id="36621"></span>36621</td>
<td class="instruction">LD H,A</td>
</tr>
<tr>
<td class="address-1"><span id="36622"></span>36622</td>
<td class="instruction">LD (36488),HL</td>
<td class="comment-1" rowspan="1">Store the updated address</td>
</tr>
<tr>
<td class="address-1"><span id="36625"></span>36625</td>
<td class="instruction">RET</td>
<td class="comment-1" rowspan="1">Return</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="36586.html">36586</a>
</td>
<td class="up">Up: <a href="../maps/all.html#36606">Map</a></td>
<td class="next">
Next: <a href="36626.html">36626</a>
</td>
</tr>
</table>
<footer>
<div class="release">The Complete Spellbound (48k) RAM Disassembly 08/05/2021</div>
<div class="copyright">&#169; 1985 David Jones / Mastertronic (Spellbound). &#169; 2010-2021 Philip M. Anderson (this disassembly). Contact: weyoun47-AT-gmail.com.</div>
<div class="created">Created using <a class="link" href="http://skoolkit.ca/">SkoolKit</a> 8.4.</div>
</footer>
</body>
</html>