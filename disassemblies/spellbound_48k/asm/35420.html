<!DOCTYPE html>
<html>
<head>
<title>Spellbound (48k): Unused RAM at 35420</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
<link rel="stylesheet" type="text/css" href="../common.css" />
<link rel="stylesheet" type="text/css" href="../spectrum.css" />
<link rel="stylesheet" type="text/css" href="../spellbound.css" />
<script type="text/javascript" src="../js/require.js"></script>
<script type="text/javascript" src="../js/main.js"></script>
<script type="text/javascript" src="../js/bootstrap.js"></script>
</head>
<body class="Asm-u">
<table class="header">
<tr>
<td class="logo"><a href="../index.html"><img alt="logo" src="../images/logo.png" /></a></td>
<td class="page-header">Unused</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="35393.html">35393</a>
</td>
<td class="up">Up: <a href="../maps/all.html#35420">Map</a></td>
<td class="next">
Next: <a href="35495.html">35495</a>
</td>
</tr>
</table>
<div class="description">35420: Select Magic Knight's room (cheat / debug routine)</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
</div>
</td>
</tr>
<tr>
<td class="address-1"><span id="35420"></span>35420</td>
<td class="instruction">CALL <a href="38183.html">38183</a></td>
<td class="comment-1" rowspan="1">Play cheat routine sound</td>
</tr>
<tr>
<td class="address-1"><span id="35423"></span>35423</td>
<td class="instruction">CALL <a href="26835.html">26835</a></td>
<td class="comment-1" rowspan="1">Wait for a key-press then beep, loading index of pressed key into <span class="register">A</span></td>
</tr>
<tr>
<td class="address-1"><span id="35426"></span>35426</td>
<td class="instruction">CP 88</td>
<td class="comment-1" rowspan="1">If "X" is pressed...</td>
</tr>
<tr>
<td class="address-1"><span id="35428"></span>35428</td>
<td class="instruction">JP Z,26742</td>
<td class="comment-1" rowspan="1">...then return to BASIC</td>
</tr>
<tr>
<td class="address-1"><span id="35431"></span>35431</td>
<td class="instruction">CP 48</td>
<td class="comment-1" rowspan="1">If a key with an index lower than "0" is pressed then exit this routine...</td>
</tr>
<tr>
<td class="address-1"><span id="35433"></span>35433</td>
<td class="instruction">JP M,35489</td>
<td class="comment-1" rowspan="1">...</td>
</tr>
<tr>
<td class="address-1"><span id="35436"></span>35436</td>
<td class="instruction">CP 53</td>
<td class="comment-1" rowspan="1">If a key with an index equal to or higher than "5" is pressed then exit this routine...</td>
</tr>
<tr>
<td class="address-1"><span id="35438"></span>35438</td>
<td class="instruction">JP NC,35489</td>
<td class="comment-1" rowspan="1">...</td>
</tr>
<tr>
<td class="address-1"><span id="35441"></span>35441</td>
<td class="instruction">SUB 48</td>
<td class="comment-1" rowspan="1">Subtract 48 (ASCII code for "0") from index of key pressed to convert to a number</td>
</tr>
<tr>
<td class="address-1"><span id="35443"></span>35443</td>
<td class="instruction">LD B,A</td>
<td class="comment-1" rowspan="1">Multiply number by 10 in <span class="register">A</span>...</td>
</tr>
<tr>
<td class="address-1"><span id="35444"></span>35444</td>
<td class="instruction">ADD A,A</td>
<td class="comment-1" rowspan="1">...</td>
</tr>
<tr>
<td class="address-1"><span id="35445"></span>35445</td>
<td class="instruction">ADD A,A</td>
<td class="comment-1" rowspan="1">...</td>
</tr>
<tr>
<td class="address-1"><span id="35446"></span>35446</td>
<td class="instruction">ADD A,B</td>
<td class="comment-1" rowspan="1">...</td>
</tr>
<tr>
<td class="address-1"><span id="35447"></span>35447</td>
<td class="instruction">ADD A,A</td>
<td class="comment-1" rowspan="1">...</td>
</tr>
<tr>
<td class="address-1"><span id="35448"></span>35448</td>
<td class="instruction">LD (65529),A</td>
<td class="comment-1" rowspan="1">Set Magic Knight's current room to this value</td>
</tr>
<tr>
<td class="address-1"><span id="35451"></span>35451</td>
<td class="instruction">CALL <a href="26835.html">26835</a></td>
<td class="comment-1" rowspan="1">Wait for a key-press then beep, loading index of pressed key into <span class="register">A</span></td>
</tr>
<tr>
<td class="address-1"><span id="35454"></span>35454</td>
<td class="instruction">CP 88</td>
<td class="comment-1" rowspan="1">If "X" is pressed...</td>
</tr>
<tr>
<td class="address-1"><span id="35456"></span>35456</td>
<td class="instruction">JP Z,26742</td>
<td class="comment-1" rowspan="1">...then return to BASIC</td>
</tr>
<tr>
<td class="address-1"><span id="35459"></span>35459</td>
<td class="instruction">CP 48</td>
<td class="comment-1" rowspan="1">If a key with an index lower than "0" is pressed then exit this routine...</td>
</tr>
<tr>
<td class="address-1"><span id="35461"></span>35461</td>
<td class="instruction">JP M,35489</td>
<td class="comment-1" rowspan="1">...</td>
</tr>
<tr>
<td class="address-1"><span id="35464"></span>35464</td>
<td class="instruction">CP 58</td>
<td class="comment-1" rowspan="1">If a key with an index equal to or higher than ":" (one immediately after "9") is pressed then exit this routine...</td>
</tr>
<tr>
<td class="address-1"><span id="35466"></span>35466</td>
<td class="instruction">JP NC,35489</td>
<td class="comment-1" rowspan="1">...</td>
</tr>
<tr>
<td class="address-1"><span id="35469"></span>35469</td>
<td class="instruction">SUB 48</td>
<td class="comment-1" rowspan="1">Subtract 48 (ASCII code for "0") from index of key pressed to convert to a number</td>
</tr>
<tr>
<td class="address-1"><span id="35471"></span>35471</td>
<td class="instruction">LD B,A</td>
<td class="comment-1" rowspan="1">Add value of this second digit to value in Magic Knight's current room...</td>
</tr>
<tr>
<td class="address-1"><span id="35472"></span>35472</td>
<td class="instruction">LD A,(65529)</td>
<td class="comment-1" rowspan="1">...</td>
</tr>
<tr>
<td class="address-1"><span id="35475"></span>35475</td>
<td class="instruction">ADD A,B</td>
<td class="comment-1" rowspan="1">...</td>
</tr>
<tr>
<td class="address-1"><span id="35476"></span>35476</td>
<td class="instruction">LD (65529),A</td>
<td class="comment-1" rowspan="1">...</td>
</tr>
<tr>
<td class="address-1"><span id="35479"></span>35479</td>
<td class="instruction">XOR A</td>
<td class="comment-1" rowspan="1">Set Magic Knight's current frame to erase to zero (frame 0 is blank graphic data) so Magic Knight is drawn but not erased...</td>
</tr>
<tr>
<td class="address-1"><span id="35480"></span>35480</td>
<td class="instruction">LD (25389),A</td>
<td class="comment-1" rowspan="1">...</td>
</tr>
<tr>
<td class="address-1"><span id="35483"></span>35483</td>
<td class="instruction">CALL <a href="38108.html">38108</a></td>
<td class="comment-1" rowspan="1">Set parameters for and play downward scale sound</td>
</tr>
<tr>
<td class="address-1"><span id="35486"></span>35486</td>
<td class="instruction">JP <a href="27168.html">27168</a></td>
<td class="comment-1" rowspan="1">Redraw current room and return to game</td>
</tr>
<tr>
<td class="address-2"><span id="35489"></span>35489</td>
<td class="instruction">CALL <a href="38183.html">38183</a></td>
<td class="comment-1" rowspan="1">Play cheat routine sound</td>
</tr>
<tr>
<td class="address-1"><span id="35492"></span>35492</td>
<td class="instruction">JP <a href="27176.html">27176</a></td>
<td class="comment-1" rowspan="1">Jump to start of main game loop</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="35393.html">35393</a>
</td>
<td class="up">Up: <a href="../maps/all.html#35420">Map</a></td>
<td class="next">
Next: <a href="35495.html">35495</a>
</td>
</tr>
</table>
<footer>
<div class="release">The Complete Spellbound (48k) RAM Disassembly 10/04/2021</div>
<div class="copyright">&#169; 1985 David Jones / Mastertronic (Spellbound). &#169; 2010-2021 Philip M. Anderson (this disassembly). Contact: weyoun47-AT-gmail.com.</div>
<div class="created">Created using <a class="link" href="http://skoolkit.ca/">SkoolKit</a> 8.4.</div>
</footer>
</body>
</html>