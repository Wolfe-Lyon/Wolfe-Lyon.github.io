<!DOCTYPE html>
<html>
<head>
<title>Stormbringer (48k): Routine at 63247</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
<link rel="stylesheet" type="text/css" href="../common.css" />
<link rel="stylesheet" type="text/css" href="../spectrum.css" />
<link rel="stylesheet" type="text/css" href="../stormbringer.css" />
<script type="text/javascript" src="../js/require.js"></script>
<script type="text/javascript" src="../js/main.js"></script>
<script type="text/javascript" src="../js/bootstrap.js"></script>
</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html"><img alt="logo" src="../images/logo.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="63233.html">63233</a>
</td>
<td class="up">Up: <a href="../maps/all.html#63247">Map</a></td>
<td class="next">
Next: <a href="63263.html">63263</a>
</td>
</tr>
</table>
<div class="description">63247: Advance bitmap virtual text cursor right by one character</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
<div class="paragraph">
Used by the routines at <a href="41271.html">41271</a>, <a href="48389.html">48389</a> and <a href="63005.html">63005</a>.
</div>
</div>
</td>
</tr>
<tr>
<td class="address-2"><span id="63247"></span>63247</td>
<td class="instruction">LD HL,(63018)</td>
<td class="comment-1" rowspan="1">Load <span class="register">HL</span> with address of bitmap virtual text cursor...</td>
</tr>
<tr>
<td class="address-1"><span id="63250"></span>63250</td>
<td class="instruction">INC HL</td>
<td class="comment-1" rowspan="1">...and increase (for next character)</td>
</tr>
<tr>
<td class="address-1"><span id="63251"></span>63251</td>
<td class="instruction">LD A,L</td>
<td class="comment-1" rowspan="1">Load LSB of <span class="register">HL</span> into <span class="register">A</span>...</td>
</tr>
<tr>
<td class="address-1"><span id="63252"></span>63252</td>
<td class="instruction">OR A</td>
<td class="comment-1" rowspan="1">...and check whether it is zero</td>
</tr>
<tr>
<td class="address-1"><span id="63253"></span>63253</td>
<td class="instruction">JR NZ,63259</td>
<td class="comment-1" rowspan="1">If it is not zero (i.e. advancing down a character row will not take us into a different third) then skip ahead to <a href="63247.html#63259">63259</a></td>
</tr>
<tr>
<td class="address-1"><span id="63255"></span>63255</td>
<td class="instruction">LD A,H</td>
<td class="comment-1" rowspan="3">Add 7 to MSB of display file address as advancing by one at <a href="63247.html#63250">63250</a> took display file pointer back up to 2nd pixel row of the current third of the display when in fact we need to move to top pixel row of the NEXT third of the display (i.e. 7 &times; 32 &times; 8 = 7 &times; 256 bytes on from this!)</td>
</tr>
<tr>
<td class="address-1"><span id="63256"></span>63256</td>
<td class="instruction">ADD A,7</td>
</tr>
<tr>
<td class="address-1"><span id="63258"></span>63258</td>
<td class="instruction">LD H,A</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="63259"></span>
<div class="comments">
<div class="paragraph">
This entry point is used by the routines at <a href="63203.html">63203</a>, <a href="63263.html">63263</a>, <a href="63349.html">63349</a> and <a href="63399.html">63399</a>.
</div>
</div>
</td>
</tr>
<tr>
<td class="address-2"><span id="63259"></span>63259</td>
<td class="instruction">LD (63018),HL</td>
<td class="comment-1" rowspan="1">Store the updated address of bitmap virtual text cursor</td>
</tr>
<tr>
<td class="address-1"><span id="63262"></span>63262</td>
<td class="instruction">RET</td>
<td class="comment-1" rowspan="1">Return</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="63233.html">63233</a>
</td>
<td class="up">Up: <a href="../maps/all.html#63247">Map</a></td>
<td class="next">
Next: <a href="63263.html">63263</a>
</td>
</tr>
</table>
<footer>
<div class="release">The Complete Stormbringer (48k) RAM Disassembly 10/04/2021</div>
<div class="copyright">&#169; 1987 David Jones / Mastertronic (Stormbringer). &#169; 2014-2021 Philip M. Anderson (this disassembly). Contact: weyoun47-AT-gmail.com.</div>
<div class="created">Created using <a class="link" href="http://skoolkit.ca/">SkoolKit</a> 8.4.</div>
</footer>
</body>
</html>